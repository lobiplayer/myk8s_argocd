# TOKEN_REVIEW_JWT=eyJhbGciOiJSUzI1NiIsImtpZCI6Ik10RzBMRlgydVloTU9WQld2SnM5cFFNdGVkWmtzWTRFS2wzQjB2ZXN5dVUifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJkZWZhdWx0Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZWNyZXQubmFtZSI6Imlzc3Vlci10b2tlbi1sbXpwaiIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50Lm5hbWUiOiJpc3N1ZXIiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC51aWQiOiIxYzU1MTgyNy1mOTU0LTRhNGQtODE4ZS0xMTZhNDgxZmYzYmUiLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6ZGVmYXVsdDppc3N1ZXIifQ.VZxHMAbXORUBhmvcrbaY0KJA24vsb8oSHwb3T9XqSIySE1M-m7lkGDd4gwweOMF2umOfp0PkHQWc9cymZnEhJuJbmZJqu0nkMSuQNI7c_YwaPaU4USn7JU5VL3Fxw5BY4VatgS-FgY9jA-dnF6MV1WHbBNNiLAcSEX1IsvY30T2CtcbniMxXCjcP_bx6Jxcmcuyd-i4tUqhFtZY6ECCHf6f-MBahqKbtAZ_-KclWAa8NHOc1fYVvQo-95cBSdSf1o8QPh_IjCmJvXeLcSVLTeacre2U0WO7t6eHHJUKSv8hx4UxdnCCUIKzw2HNRQgGdZNAf1lTdr4upo3ZEFY0_Vg
TOKEN_REVIEW_JWT=eyJhbGciOiJSUzI1NiIsImtpZCI6Ik9jZFpWM2VfMXd1aU55Rkx3MFRZWGVOaGMxcTdUM2RsOU9UVVlha0ZzS1UifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJjZXJ0LW1hbmFnZXIiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlY3JldC5uYW1lIjoiY2x1c3Rlcmlzc3Vlci10b2tlbi1sbXpwaiIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50Lm5hbWUiOiJjbHVzdGVyaXNzdWVyIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiMTJjZDU5MjAtYjc1Ny00OTE5LTg5ZjUtNDgwZDY3NjM5ZGY2Iiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50OmNlcnQtbWFuYWdlcjpjbHVzdGVyaXNzdWVyIn0.IL1kLK3TIW_X5sIjdBGv6mgJdGj1KY4qwOrc-q0xmH6dzpCGyOBxjpPubB4I8mvFAZIaL2CAki8ePCZK8nqFyC4EvJXqbCLm_nDnUSsykV6w6nFoaXzZHjkjQYT0jJ-vo4w3j3ixave3qAF8cMvAO3Dzg46WvTsqlkvTqgP1VdldC2bY8o-FjJusfFGIC0Ze7l0xnPmo8zokmfl1lY6zqGUh87_v2g_ulHDDSSxtsPVvJSp6bgUCStBNQKiNYaYBnRsT6CskKailZf1Zs9K-V1Jyt-7kMc1fhSW7uMHtCmZJeaJj7DVIzTyxtR3dL--U4syVsiYcsikpG72K-yi_Ig
KUBE_CA_CERT=$(kubectl config view --raw --minify --flatten --output='jsonpath={.clusters[].cluster.certificate-authority-data}' | base64 --decode)
KUBE_HOST="https://$KUBERNETES_PORT_443_TCP_ADDR:443"

vault write auth/kubernetes/config \
     token_reviewer_jwt="$TOKEN_REVIEW_JWT" \
     kubernetes_host="$KUBE_HOST" \
     kubernetes_ca_cert="$KUBE_CA_CERT" \
     issuer="https://kubernetes.default.svc.cluster.local"